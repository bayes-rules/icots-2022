---
title: "Bayesian Regression"
author: "Mine Dogucu"
output: 
  html_document:
    css: "activity-style.css"
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      fig.height = 3,
                      fig.width = 4,
                      fig.align = 'center')
```

\
\


**Getting started**

- We have provided an `.Rmd` file for this activity: `R/03-regression-activity.Rmd`. We recommend that you avoid knitting often and rely more on the `Run Current Chunk` feature, as it will take some time to simulate the Bayesian models.

- If you prefer to use an `R` file, first make sure that you're working within your directory with the repo files, and then run the following from the Console:    
    `knitr::purl("R/03-regression-activity.Rmd", "R/03-regression-activity.R")`    
     
     This will create an R file with the activity R code. For the corresponding discussion and prompts, see the `R/03-regression-activity.html` file in the repo.
    

\
\



    

## Exploratory analysis

```{r message=FALSE, warning=FALSE}
# Load packages
library(bayesrules)
library(tidyverse)
library(rstan)
library(rstanarm)
library(bayesplot)
library(tidybayes)
library(janitor)
library(broom.mixed)
```


```{r}
# Load data
data(bikes)

# Construct a scatterplot
ggplot(bikes, aes(x = temp_feel, y = rides)) + 
  geom_point(size = 0.5) + 
  geom_smooth(method = "lm", se = FALSE)
```


Based on the plot above, comment on the relationship between `temp_feel` and `rides`. 
Consider whether the relationship is: 1) linear; 2) positive; 3) strong or not.


## Building the regression model

## Tuning prior models for regression parameters

(some comment about pretending that we haven't yet seen the data)

```{r}
plot_normal(mean = 5000, sd = 1000) + 
  labs(x = "beta_0c", y = "pdf")
plot_normal(mean = 100, sd = 40) + 
  labs(x = "beta_1", y = "pdf")
plot_gamma(shape = 1, rate = 0.0008) + 
  labs(x = "sigma", y = "pdf")
```


## Posterior simulation

```{r}
bike_model <- stan_glm(rides ~ temp_feel, data = bikes,
                       family = gaussian,
                       prior_intercept = normal(5000, 1000),
                       prior = normal(100, 40), 
                       prior_aux = exponential(0.0008),
                       chains = 4, iter = 5000*2, seed = 84735, refresh = FALSE)
```


## Interpreting the posterior


## Posterior prediction

<div id= "attention"> Here is some important note </div>

## More than one predictor

### Posterior Simulation

### Model Evaluation

## Moving beyond normal

If you are done early and want to look around for further modeling contexts, feel free to check out [Poisson and Negative Binomial Regression](https://www.bayesrulesbook.com/chapter-12.html), [Logistic Regression](https://www.bayesrulesbook.com/chapter-13.html), and/or [Naive Bayes Classification](https://www.bayesrulesbook.com/chapter-14.html) chapters in the book.

## Discussion


